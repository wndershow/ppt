<!doctype html><html><head><meta charset=UTF-8><title>小程序实践分享 - By jiazhen.ding</title><link rel=stylesheet href=//cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=//cdn.staticfile.org/prism/1.15.0/themes/prism.min.css><link rel=stylesheet href=//cdn.staticfile.org/KaTeX/0.10.0-rc.1/katex.min.css><link href=./css/chunk-vendors.5fc1bfa6.css rel=stylesheet></head><body><div><article id=webslides><section slide class="slide bg-blue aligncenter" video="https://webslides.tv/static/videos/working.mp4 poster='https://webslides.tv/static/images/working.jpg' .light"><video poster=https://webslides.tv/static/images/working.jpg loop muted autoplay preload=true class="background-video light"><source src=https://webslides.tv/static/videos/working.mp4></video><div class=wrap wrap=true><h1 class="text-landing text-shadow">小程序实践分享</h1><p class=text-intro>By jiazhen.ding</p><p><a href=https://github.com/wndershow/ppt/mp-share.md class="button ghost" target=_blank><i class="fa fa-github"></i> Github</a></p></div></section><section slide class=slide :class="aligncenter size-50"><div class="wrap aligncenter size-50" wrap=true><h3>分享主题</h3><ul class=flexblock><li><h2>特点</h2><h2>架构设计</h2><h2>工程化实践</h2><h2>认证授权</h2><h2>性能优化</h2></li><li><h2>引流有关</h2><h2>模板消息处理</h2><h2>状态管理</h2><h2>开发工具</h2></li></ul></div></section><section slide class=slide :class="size-50 aligncenter"><header><div class=wrap><p>特性 -》 主题</p></div></header><div class="wrap size-50 aligncenter" wrap=true><h2>特性</h2><p>即用即走，随手可得</p></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>特性 -》 发展历程</p></div></header><div class="wrap aligncenter" wrap=true><div class=grid><div class=column><h3>JS-SDK</h3><p>微信 JS-SDK 作为 WeixinJSBridge 的封装，使微信 H5 拥有了原生的一些能力。</p></div><div class=column><h3>Web 离线存储</h3><p>微信 web 离线存储加速文案，一定程度上降低了白屏的不良体验</p></div><div class=column><h3>小程序</h3><p>主要解决了白屏问题和不流畅的用户体验，提供了更为丰富的原生 API。</p></div></div></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>特性 -》 小程序与 PWA</p></div></header><div class="wrap aligncenter" wrap=true><div class=grid><div class=column><h3>小程序</h3><ul><li><p>拥有离线能力</p></li><li><p>微信生态</p></li><li><p>媲美原生操作体验</p></li><li><p>将低了开发门槛，提高了开发效率高</p></li></ul></div><div class=column><h3>PWA</h3><p>（App Manifest、Service Worker、Web Push）</p><ul><li><p>兼顾 web app 和 native app 的优点</p></li><li><p>网络可靠性、可离线、消息推送</p></li></ul></div></div></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>特性 -》 适用场景</p></div></header><div class="wrap aligncenter" wrap=true><h4>借助微信生态，引流辅助工具，快速实现 MVP。</h4></div></section><section slide class=slide :class="size-50 aligncenter"><header><div class=wrap><p>架构设计 -》 主题封面</p></div></header><div class="wrap size-50 aligncenter" wrap=true><h2>架构设计</h2></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 双线模型</p></div></header><div class="wrap aligncenter" wrap=true><h3>双线模型</h3><p>渲染性能，更好的安全管控</p><div class="align-left grid"><div class=column><p><img src=./img/EF5510D7-BA3E-4A66-944B-DB0700C03060.14baac6b.png alt=""></p><p>HTTP OR SOCKET</p></div><div class=column><ul><li><h5>视图层</h5></li><li><p>webview 线程只负责 UI 渲染工作，把逻辑层撇开到单独的线程中，加快了 UI 渲染速度。</p></li><li><p>结合原来组件充分利用 native 的渲染，更好的提升了渲染性能。</p></li><li><h5>逻辑层</h5></li><li><p>iOS 下的 JavaScriptCore 框架，安卓下腾讯 x5 内核的 JsCore。</p></li><li><p>通过提供一个沙箱环境来运行开发者的 JavaScript 代码来解决。</p></li><li><h5>navtive 层</h5></li><li><p>视图、逻辑、网络间的数据通讯</p></li></ul></div></div></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 数据通讯</p></div></header><div class="wrap aligncenter" wrap=true><h3>数据通讯</h3><p>天生延时</p><div class="align-left grid"><div class=column><p><img src=./img/p1.07fa24ae.png alt=""></p></div><div class=column><ul><li><p>视图层通过宿主环境发送下事件数据到逻辑层。</p></li><li><p>逻辑层通过宿主环境发送数据到视图层。</p></li><li><p>逻辑层通过宿主环境调用 native api。</p></li><li><p>this.setData({...}, callback);</p></li></ul></div></div></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 事件</p></div></header><div class="wrap aligncenter" wrap=true><h3>事件</h3><p>用户行为及组件状态反馈的抽象</p></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 事件</p></div></header><div class="wrap aligncenter" wrap=true><h3>属性</h3><p><img src=./img/p5.0a802a1b.png alt=""></p></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 事件</p></div></header><div class="wrap aligncenter" wrap=true><h3>事件冒泡</h3><div class="align-left grid"><div class=column><pre class=language-html><code class=language-html><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v3<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handle3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v2<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handle2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v1<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handle1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>click<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
</code></pre></div><div class=column><p>handle1 -&gt; handle2 -&gt; handle3</p></div></div></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 事件</p></div></header><div class="wrap aligncenter" wrap=true><h3>catch 用于阻止事件冒泡</h3><div class="align-left grid"><div class=column><pre class=language-html><code class=language-html><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v3<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handle3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v2<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">catch:</span>tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handle2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v1<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handle1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>click<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
</code></pre></div><div class=column><p>handle1 -&gt; handle2</p></div></div></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 事件</p></div></header><div class="wrap aligncenter" wrap=true><h3>捕获阶段</h3><p>位于冒泡阶段之前，顺序与冒泡阶段恰好相反</p><div class="align-left grid"><div class=column><pre class=language-html><code class=language-html><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v2<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handle4<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">capture-bind:</span>tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handle3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v1<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handle1<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">capture-bind:</span>tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handle2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>click<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
</code></pre></div><div class=column><p>handle3 -&gt; handle2 -&gt; handle1 -&gt; handle4</p></div></div></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 事件</p></div></header><div class="wrap aligncenter" wrap=true><h3>target 与 currentTarget</h3><div class="align-left grid"><div class=column><pre class=language-html><code class=language-html><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v2<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handle1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>v1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>click<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
</code></pre></div><div class=column><p>handle4 事件里的 target 为 v1</p></div></div></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 事件</p></div></header><div class="wrap aligncenter" wrap=true><h3>transitionend</h3><p>过渡动画结束后会调用</p></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 生命周期</p></div></header><div class="wrap aligncenter" wrap=true><h3>生命周期</h3><div class="align-left grid"><div class=column><pre class=language-javascript><code class=language-javascript><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">onLaunch</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"App onLaunch"</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onShow</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"App onShow"</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onHide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"App onHide"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onError</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  globalData<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class=column><pre class=language-javascript><code class=language-javascript><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"page index onLoad options包含了与些页面有关的参数"</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onShow</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>
      <span class="token string">"page index onShow 页面显示时调用，这里并没有options"</span><span class="token punctuation">,</span>
      options
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"page index all pages"</span><span class="token punctuation">,</span> <span class="token function">getCurrentPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>
      <span class="token string">"page index onReady 页面没被销毁前只会触发1次，表示页面已经准备妥当，在逻辑层就可以和视图层进行交互了。"</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onHide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"page index onHide 页面进入后台时调用"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onUnload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"page index onUnload 页面从页面栈移出前调用。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class=column><pre class=language-javascript><code class=language-javascript><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里可以给组件添加一些自定义属性，不好调用setData()</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">pageLifetimes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'page show'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'page hide'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  lifetimes<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">attached</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">moved</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">detached</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 生命周期</p></div></header><div class="wrap aligncenter" wrap=true><h3>app onLaunch 里 option 的参数</h3><p><img src=./img/p6.d70d59ff.png alt=""></p></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 生命周期</p></div></header><div class="wrap aligncenter" wrap=true><h3>跳转</h3><ul><li><p>navigateTo</p></li><li><p>redirectTo</p></li><li><p>switchTab</p></li><li><p>reLaunch</p></li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 生命周期</p></div></header><div class="wrap aligncenter" wrap=true><h3>实践性 TIP</h3><ul><li><p>不要在 onLaunch 的时候调用 getCurrentPages()</p></li><li><p>wx.setNavigationBarTitle 写在 onReady 事件里</p></li><li><p>始终注意着页面栈变化。</p></li><li><p>tabbar 一旦加载即使在页面栈中移除也不会被销毁。</p></li><li><p>页面栈数量 10</p></li><li><p>setData() 次数和数据量尽可能小，数据限制 1024kb，与视图有关的放this当前组件里</p></li><li><p>入口页面把与请求有的东西放在 onShow 里</p></li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 生命周期</p></div></header><div class="wrap aligncenter" wrap=true><h3>let {id} = getParams();</h3><div class="align-left grid"><div class=column><pre class=language-javascript><code class=language-javascript><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getCurrentPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> pages <span class="token operator">=</span> <span class="token function">getCurrentPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> currentPage <span class="token operator">=</span> pages<span class="token punctuation">[</span>pages<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> currentPage<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getParams</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> currentPage <span class="token operator">=</span> <span class="token function">getCurrentPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> options <span class="token operator">=</span> currentPage<span class="token punctuation">.</span>options <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> options<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class=column><ul><li><p>因为 page onShow 里取不到。</p></li><li><p>你可能要在组件中获取页面参数。</p></li><li><p>因为小程序在 navigate back 来 back 去的时候参数可能会错乱。</p></li></ul></div></div></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 运行更新机制</p></div></header><div class="wrap aligncenter" wrap=true><h3>冷启动与热启动</h3><ul><li>冷启动：是用户首次打开或小程序被微信主动销毁后再次打开的情况</li><li>热启动：后台态的小程序切换到前台</li><li>热启动所有状态都会保留</li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 运行更新机制</p></div></header><div class="wrap aligncenter" wrap=true><h3>运行时销毁时机</h3><ul><li>后台 5 分钟会被系统销毁</li><li>5 秒间隔内连续收到两次及以上系统内存告警时</li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 运行更新机制</p></div></header><div class="wrap aligncenter" wrap=true><h3>更新机制</h3><p>小程序在冷启动时会检查更新，并异步下载代码包</p><ul><li>体验版测试时退下微信进程。</li><li>可以使用 wx.getUpdateManager API 进行处理。</li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 组件</p></div></header><div class="wrap aligncenter" wrap=true><h3>组件</h3><p>小程序里组件是 page 的赶集</p><pre class=language-javascript><code class=language-javascript>
# <span class="token operator">/</span>pages<span class="token operator">/</span>a<span class="token operator">/</span>index<span class="token punctuation">.</span>json
<span class="token punctuation">{</span>
  <span class="token string">"usingComponents"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

# <span class="token operator">/</span>pages<span class="token operator">/</span>a<span class="token operator">/</span>index<span class="token punctuation">.</span>js
<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

  properties<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    paramA<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
    paramB<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>paramA <span class="token comment">// 页面参数 paramA 的值</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>paramB <span class="token comment">// 页面参数 paramB 的值</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><ul><li></li></ul></div></section><section slide class=slide :class=aligncenter data-transition=newspaper><header><div class=wrap><p>架构设计 -》 组件</p></div></header><div class="wrap aligncenter" wrap=true><h3>组件间通讯方式</h3><ul><li>属性值传递</li><li>事件系统</li><li>selectComponent</li><li>relations</li><li>slot</li></ul></div></section><section slide class=slide :class=aligncenter data-transition=slide3><header><div class=wrap><p>架构设计 -》 组件</p></div></header><div class="wrap aligncenter" wrap=true><h3>数据的监听</h3><pre class=language-javascript><code class=language-javascript><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  observers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"firstName, lastName"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> ln</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        fullName<span class="token punctuation">:</span> fn <span class="token operator">+</span> ln
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 组件</p></div></header><div class="wrap aligncenter" wrap=true><h3>小程序里的 mixin 组件 behaviors</h3><div class=grid><div class=column><pre class=language-javascript><code class=language-javascript>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">Behavior</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  behaviors<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  properties<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    myBehaviorProperty<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> String
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    myBehaviorData<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">attached</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">myBehaviorMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class=column><pre class=language-javascript><code class=language-javascript><span class="token keyword">const</span> myBehavior <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"my-behavior"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  behaviors<span class="token punctuation">:</span> <span class="token punctuation">[</span>myBehavior<span class="token punctuation">]</span><span class="token punctuation">,</span>
  properties<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    myProperty<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> String
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    myData<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">attached</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">myMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 组件</p></div></header><div class="wrap aligncenter" wrap=true><h3>计算属性</h3><p>自定义组件扩展 definitionFilter，是提供了修改自定义组件定义段的能力</p><p><a href=https://github.com/wechat-miniprogram/computed class="button ghost" target=_blank><i class="fa fa-home"></i> Computed</a></p><pre class=language-javascript><code class=language-javascript><span class="token keyword">const</span> beh <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./behavior.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  behaviors<span class="token punctuation">:</span> <span class="token punctuation">[</span>beh<span class="token punctuation">]</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    a<span class="token punctuation">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>a <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">onTap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        a<span class="token punctuation">:</span> <span class="token operator">++</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>a
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 插件</p></div></header><div class="wrap aligncenter" wrap=true><h3>插件</h3><p>可以是页面的组合，封装可复用的功能和服务</p></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 rpx 单位</p></div></header><div class="wrap aligncenter" wrap=true><h3>相对单位 rpx</h3><p>设计师以 iphone6 作为视觉稿的标准</p></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 wxs</p></div></header><div class="wrap aligncenter" wrap=true><h3>wxs</h3><ul><li><p>可用于高性能动效，数据过滤、修饰。</p></li><li><p>不能使用 es6 相关的东西。</p></li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>架构设计 -》 多线程</p></div></header><div class="wrap aligncenter" wrap=true><h3>多线程 worker</h3><p>可以把结果返回到小程序主线程</p></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h3>小程序工程化实践</h3></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 开发目录结构</p></div></header><div class="wrap aligncenter" wrap=true><h3>开发目录结构</h3><div class=grid><div class=column><p><img src=./img/Snip20190328_2.2c7b2480.png alt=""></p></div><div class=column><ul><li>page 组件化</li><li>中线风格命名</li><li>页面模块名index</li></ul></div></div></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 框架选择</p></div></header><div class="wrap aligncenter" wrap=true><h3>框架选择</h3><p>原生态的mina</p><ul><li>完善的组件化方案</li><li>出了问题容易定位</li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 异步处理方案</p></div></header><div class="wrap aligncenter" wrap=true><h3>异步处理方案</h3><p><img src=./img/Snip20190328_3.c9c127b8.png alt=""></p><p><img src=./img/Snip20190328_6.9d8f7fdd.png alt=""></p></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 代码格式化方案</p></div></header><div class="wrap aligncenter" wrap=true><h3>代码格式化方案</h3><p>代码保存的时候格式化</p><ul><li>.prettier</li><li>编辑器prettier插件</li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 多环境方案</p></div></header><div class="wrap aligncenter" wrap=true><h3>多环境方案</h3><p>每个环境一套配置</p><p><img src=./img/Snip20190328_4.a73256ed.png alt=""></p></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 tabbar 方案</p></div></header><div class="wrap aligncenter" wrap=true><h3>tabbar 方案</h3><p>建议设计时尽可能使用小程序默认配置方案。</p><div class="align-left grid"><div class=column><h5>使用配置项</h5><ul><li>体验流畅</li><li>外观具有很大的局限性</li><li>尺寸为 81px * 81px，偏差 1px 可能都会有很大程度上的失真。</li></ul></div><div class=column><h5>基础库 2.5.0 后的 custom 方案</h5><ul><li>外观可以自主定制，体验流畅</li><li>依然存在自定义 mask 无法查档 tabbar 问题</li></ul></div><div class=column><h5>wx.hideTabBar(Object object)</h5><ul><li>用自定义组件方式实现 tabbar</li><li>在 tabbar page 时调用 wx.hideTabBar(Object object)把真实的隐藏掉</li><li>第一次点击时会有晃动的不良体验</li></ul></div></div></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 返回首页</p></div></header><div class="wrap aligncenter" wrap=true><h3>返回首页方案</h3><p>群消息卡片里进入小程序，如何返回首页</p><ul><li>自定义导航栏</li><li>先进入index，从index跳转到相当页面</li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 js 生态</p></div></header><div class="wrap aligncenter" wrap=true><h3>js 生态</h3><p>通过npm构建小范围使用</p><ul><li>npm i dayjs -s</li><li><img src=./img/Snip20190328_5.84d5f5ad.png alt=""></li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 样式方案</p></div></header><div class="wrap aligncenter" wrap=true><h3>样式方案</h3><p>定义设计标准</p></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 样式方案</p></div></header><div class="wrap aligncenter" wrap=true><h3>原子类组合 + 组件化</h3><p><a href=https://github.com/tachyons-css/tachyons target=_blank>tachyons</a></p><pre class=language-html><code class=language-html><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>flex br ba gray shawdow<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pl3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>flex-auto<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
</code></pre><p><a href=https://github.com/weilanwl/ColorUI target=_blank>ColorUI</a></p></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 样式方案</p></div></header><div class="wrap aligncenter" wrap=true><h3>base64技巧</h3><ul><li>iconfont字体图标</li><li>背景图</li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 样式方案</p></div></header><div class="wrap aligncenter" wrap=true><h3>textarea穿透</h3></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 样式方案</p></div></header><div class="wrap aligncenter" wrap=true><h3>如何使用less</h3><p>不使用</p><ul><li>样式域</li><li>原子类（变量）</li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 样式方案</p></div></header><div class="wrap aligncenter" wrap=true><h3>动效交互</h3><ul><li>wx.createIntersectionObserver 相并监听</li><li>ripples.wxss</li><li><a href=https://github.com/kevenfeng/DragSort target=_blank>拖动排序</a></li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 样式方案</p></div></header><div class="wrap aligncenter" wrap=true><h3>高清适配</h3><pre class=language-css><code class=language-css>media only screen and <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span>2<span class="token punctuation">)</span>
media only screen and <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span>3<span class="token punctuation">)</span>
</code></pre></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 API对接</p></div></header><div class="wrap aligncenter" wrap=true><h3>API联调方案</h3><p>服务端尽可能使用graphql服务</p><ul><li>并发限制</li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>工程化实践 -》 发布与持续集成方案</p></div></header><div class="wrap aligncenter" wrap=true><h3>发布与持续集成</h3><p>开发者工具的接口能力（命令行上传代码）</p><ul><li>命令行启动工具、登录、提交预览、上传代码、自动化测试</li><li>小程序可以设置不向后兼容 wx.getSystemInfoSync，wx.canIUse</li></ul></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h3>引流</h3><p>更好的利用微信生态</p></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>引流 -》 转发</p></div></header><div class="wrap aligncenter" wrap=true><h3>群信息</h3><ul><li>wx.showShareMenu --- withShareTicket:: true</li><li>shareTicket app的 onLaunch onShow里获得</li><li>wx.getShareInfo(shareTicket) 获取群信息</li><li>注意参数</li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>引流 -》 跳转</p></div></header><div class="wrap aligncenter" wrap=true><h3>跳转</h3><h5>小程序到h5 (webview)</h5><ul><li>只能在小程序内通过webview全屏打开</li><li>需要到小程序管理后台做相应配置</li></ul><h5>小程序跳转到小程序</h5><ul><li>wx.navigateMiniProgram(OBJECT) 跳转到</li><li>wx.navigateBackMiniProgram(OBJECT) 跳转回</li><li>需要到小程序管理后台做相应配置</li></ul><h5>h5到小程序（jssdk）</h5><ul><li>wx.miniProgram.navigateTo</li><li>wx.miniProgram.redirectTo</li><li>wx.miniProgram.reLaunch</li></ul><h5>公众号跳转到小程序</h5><ul><li>公众号菜单</li><li>公众号模板消息</li><li>公众号小程序绑定通知</li></ul><h5>打开app</h5><ul><li>只能调回app</li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>引流 -》 生成分享图</p></div></header><div class="wrap aligncenter" wrap=true><h3>生成分享图</h3><ul><li>drawImage 时 使用本地路径，wx.getImageInfo。</li><li>用remSize作适配</li><li>arc clip 绘制带边框的圆形头像</li><li>wx.createCanvasContext，在非page组件使用时注意传this</li><li>catchtouchmove='preventTouchMove’</li></ul></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h3>模板消息机制</h3></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>模板消息机制 -》 button样式重置</p></div></header><div class="wrap aligncenter" wrap=true><h3>form-btn</h3><div class=grid><div class=column><pre class=language-css><code class=language-css><span class="token selector">button</span><span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span>transparent<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span>block<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> 10<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">button::after</span><span class="token punctuation">{</span>
  <span class="token property">content</span><span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
  <span class="token property">-webkit-transform</span><span class="token punctuation">:</span><span class="token function">scale</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span><span class="token function">scale</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span>none<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span>transparent<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class=column><p><img src=./img/Snip20190328_7.0490cf77.png alt=""></p></div></div></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h3>性能优化</h3></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>性能优化 -》 常规优化</p></div></header><div class="wrap aligncenter" wrap=true><h3>常规优化</h3><ul class=build><li>setData 次少，量少，与视图无关的状态数据保存于当前组件</li><li>骨架图</li><li>缓存数据</li><li>分包优化首次打开时的速度</li><li>注意setTimeout setInterval 在页面转场后的清理</li><li>事件处理时组件的data放入尽可能少的数据</li><li>尽量避免页面里定义onPageScroll，注意防抖</li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>性能优化 -》 长列表</p></div></header><div class="wrap aligncenter" wrap=true><h3>长列表</h3><p><a href=https://github.com/wechat-miniprogram/recycle-view target=_blank>recycle-view</a></p><p>计算只需要渲染的数据，不需要渲染的留空</p></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>性能优化 -》 预加载</p></div></header><div class="wrap aligncenter" wrap=true><h3>页预加载方案</h3><ul><li>封装navigate组件 主动加载</li><li>模拟setData 先暂存再设置</li></ul></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h3>开发者工具</h3></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>开发者工具 -》 多账号调试</p></div></header><div class="wrap aligncenter" wrap=true><h3>多账号调试</h3><p><img src=./img/Snip20190328_8.872850f7.png alt=""></p></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>开发者工具 -》 调优面板</p></div></header><div class="wrap aligncenter" wrap=true><h3>调优面板</h3><p><img src=./img/Snip20190328_12.cb309572.png alt=""></p></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h3>认证授权</h3></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>认证授权 -》 认证流程</p></div></header><div class="wrap aligncenter" wrap=true><h3>认证流程</h3><ul class=build><li>用户访问入口</li><li>调用业务接口</li><li>业务接口返回401</li><li>wx.request拦截到401状态转向到auth page</li><li>auth page里进入登录确认用户身份</li><li>auth page认证成功后跳转到入口页</li><li>入口业访问业务接口获取业务数据</li></ul></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>认证授权 -》 二次授权</p></div></header><div class="wrap aligncenter" wrap=true><h3>二次授权</h3><p>wx.createRecordContext</p><p>wx.getRecorderManager</p><p>wx.openSetting</p></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h3>状态管理</h3></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>状态管理 -》 westore</p></div></header><div class="wrap aligncenter" wrap=true><h3>westore</h3><p><a href=https://github.com/Tencent/westore target=_blank>westore状态管理工具</a>，进阶版 <a href=https://github.com/Tencent/omi/tree/master/packages/omix target=_blank>omix</a></p><p><img src=./img/Snip20190328_13.2020fcc1.png alt=""></p></div></section><section slide class=slide :class=aligncenter><header><div class=wrap><p>状态管理 -》 wx.request</p></div></header><div class="wrap aligncenter" wrap=true><h3>wx.request + graphql</h3><p>把80% 的领域模型数据，标准化到本地缓存.</p><p><img src=./img/Snip20190328_14.68c2c648.png alt=""></p></div></section></article></div><script>window.pluginsOptions = {}



document.addEventListener('DOMContentLoaded', () => {
    const ws = new WebSlides({
        loop: false
    })
    window.wsInstance = ws;
}, false)</script><script src=./js/chunk-vendors.31ecd85e.js></script><script src=./js/mp-share.fb22ec69.js></script></body></html>